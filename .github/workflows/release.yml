on:
  workflow_call:
    inputs:
      krn-core-version:
        default: 0.4.0+20240126-1532
        required: false
        type: string
      build-xml-path:
        default: build.xml
        required: false
        type: string
      build-arguments:
        default: ''
        required: false
        type: string
      mmojo-name:
        default: ${{ github.event.repository.name }}
        required: false
        type: string

jobs:
  compile:
    uses: krn-sebastiaan/mmojo-workflows/.github/workflows/compile.yml@main
    secrets: inherit
    with:
      krn-core-version: ${{ inputs.krn-core-version }}
      build-xml-path: ${{ inputs.build-xml-path }}
      build-arguments: ${{ inputs.build-arguments }}
      mmojo-name: ${{ inputs.mmojo-name }}

  publish:
    needs: compile
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: actions/download-artifact@v4
      - uses: softprops/action-gh-release@master
        with:
          files: ${{ inputs.mmojo-name }}/*
